### CLAUDE 协作指南（AI 开发助手说明）

> 面向使用 Claude/通用 LLM 作为协作者时的约定与工作流。本项目为前端多包工作区（pnpm workspace，Vite + Vue3 + TS）。请严格遵循本文档，确保自动化修改可直接运行且符合项目规范。

---

## 目标
- **一致性**: 生成的代码与文档风格统一、可读、可维护。
- **可运行**: 引入依赖、导入语句、类型定义齐全，变更后可直接启动与构建。
- **最小侵入**: 只在必要位置修改，不重排无关代码。
- **安全合规**: 不引入敏感信息与外部不可控脚本。

## 项目关键信息
- 包管理器: `pnpm`
- 构建工具: `Vite`
- 前端框架: `Vue 3` + `TypeScript`
- 代码风格与校验: `eslint` + 项目内配置（见 `eslint.config.js`）
- 主要入口: `src/main.ts`，根路由与布局在 `src/layout/`、`src/router/`

## 生成代码要求
1. 维持现有缩进与格式（不混用空格/Tab，不随意重排导入）。
2. TypeScript：导出/公共 API 显式类型；避免 `any` 与不安全断言。
3. 控制流：优先早返回、浅层嵌套；错误必须有意义处理，不空捕获。
4. 注释：仅在复杂处添加简短说明，解释“为何”而非“如何”。
5. 文件修改粒度小且聚焦：不改无关代码；删除无用代码需注明理由。
6. 新依赖需写入 `package.json` 并使用 `pnpm install` 安装。
7. 变更后需保证：`pnpm dev` 可启动，`pnpm build` 可通过，`pnpm lint` 无错误。

## 提交与分支规范
- 分支：
  - `main`：稳定发布分支
  - `feat/*`：新功能
  - `fix/*`：缺陷修复
  - `chore/*`：构建/依赖/脚手架
- 提交信息（建议遵循 Conventional Commits）：
  - `feat: 描述` / `fix: 描述` / `docs: 描述` / `refactor: 描述` / `chore: 描述`

## 工作流（AI 协作）
1. 发现阶段：
   - 读取相关文件，定位修改点（优先最小范围）。
   - 若需多文件变更，先列出 Todo（分解为 2-5 个原子任务）。
2. 实施阶段：
   - 先编辑类型与接口，再实现逻辑，最后补充样式/文案。
   - 每完成一步，运行本地校验（见下方命令）。
3. 验证阶段：
   - 启动开发服务器进行手测关键路径。
   - 构建产物确认无错误后提交。

## 常用命令
```bash
pnpm install
pnpm dev
pnpm build
pnpm lint
```

## 重要目录速览
- `src/ai/`：多平台 LLM 接入与类型
- `src/components/`：通用组件与渲染单元（含 Markdown/消息渲染）
- `src/service/`：数据请求与业务服务层
- `src/stores/`：Pinia 状态
- `src/utils/`：通用工具函数
- `src/views/`：页面级视图

## PR 描述模板
```markdown
### 变更内容
- [ ] 功能新增 / [ ] 缺陷修复 / [ ] 文档 / [ ] 重构 / [ ] 其他

### 背景与动机
简述问题与目标。

### 具体修改
- 关键文件与核心逻辑点列表

### 兼容性与影响面
- 影响的模块/页面
- 是否有破坏性变更：是/否（如“是”，需给出迁移说明）

### 校验结果
- 本地启动通过：是/否
- 构建通过：是/否
- Lint 通过：是/否

### 截图/录屏（可选）
```

## 安全与隐私
- 不提交任何密钥、Token、Cookie、内网地址。
- 不引入来自不可信 CDN 的脚本；如需第三方库，使用 `package.json` 管理。

## 限制与注意
- 不生成大段与当前任务无关的说明文档。
- 不输出二进制或超长哈希。
- 大改动必须分多次、小步提交；每次保持可运行。

---

如需 AI 执行具体修改，请直接下达精确指令（文件路径 + 目标行为 + 成功标准）。


